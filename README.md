# prog555

check it up !!!!!!

Я создал три файла скриптов и вложил команды в каждый из них в следующем порядке, чтобы проверить рекурсию execute_script: (1.hello)---> (2.script)---> (3.script2)

Проблемы и их решения:

Исправление вложенного выполнения скриптов Проблема: В классе ExecuteScriptCommand использовался один Scanner для чтения команд из файла. Это приводило к ошибкам при рекурсивном вызове скриптов (например, если один скрипт вызывал другой через execute_script). При этом терялись данные из исходного источника ввода.
Решение: Введён стек (Deque) в MainApp для управления источниками ввода. При запуске скрипта новый Scanner добавляется в стек, а после завершения — удаляется. Это позволяет корректно переключаться между источниками (консолью и файлами) и избежать конфликтов.

Исправление структуры XML Проблема: Все элементы LabWork записывались в одном теге , что делало XML-файл недействительным. Также отсутствовал корневой тег, что нарушало стандарт структуры XML.
Решение: Каждый LabWork теперь оборачивается в свой тег , а все элементы находятся внутри корневого тега . Это обеспечивает валидность XML и корректное чтение/запись данных.

Улучшение сравнения объектов в add_if_max Проблема: Метод compareTo() в классе LabWork сравнивал объекты только по id, что не соответствовало логике команды add_if_max, требующей сравнения по другим полям.
Решение: Метод compareTo() был переписан для сравнения по полям minimalPoint, averagePoint и name. Теперь команда add_if_max корректно определяет, является ли новый элемент наибольшим.

Исправление неправильного сопоставления команд Проблема: В CommandManager некоторые команды были привязаны к неправильным классам. Например, remove_greater ссылалась на AddIfMaxCommand, что вызывало ошибки.
Решение: В методе initCommands() были исправлены сопоставления команд с их классами. Теперь каждая команда связана с нужным обработчиком.

Обработка ввода в скриптах Проблема: Команды, требующие дополнительного ввода (например, add или update), вызывали ошибку No line found, так как источник ввода не сохранялся.
Решение: Использование стека scannerStack во всех точках программы, где требуется чтение ввода. Это гарантирует, что текущий источник ввода (консоль или файл) всегда доступен.

6.Предотвращение бесконечной рекурсии скриптов Проблема: При вызове скрипта из самого себя (например, hello.txt вызывает hello.txt) происходила бесконечная рекурсия.

Решение: В ExecuteScriptCommand добавлен набор activeScripts для отслеживания активных файлов скриптов. Если скрипт уже выполняется, выводится сообщение об ошибке.
